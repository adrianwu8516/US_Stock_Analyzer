<? var category = Object.keys(noteObj) ?>

<section id="tabs" class="project-tab">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <nav>
                            <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
                                <? for(var cat in category){ ?>
                                  <? if(cat == 0){?>
                                    <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#<?= category[cat] ?>" role="tab" aria-controls="nav-home" aria-selected="true"><?= category[cat] ?></a>
                                  <?}else{ ?>
                                    <a class="nav-item nav-link" id="nav-home-tab" data-toggle="tab" href="#<?= category[cat] ?>" role="tab" aria-controls="nav-home" aria-selected="true"><?= category[cat] ?></a>
                                  <?}?>
                                <?}?>
                             </div>
                        </nav>
                        <div class="tab-content" id="nav-tabContent">
                          <? for(var cat in category){ ?>
                            <? var catInfo = noteObj[category[cat]] ?>
                            <div class="tab-pane fade  <? if(cat==0){?> show active <?} ?>" id="<?= category[cat] ?>" role="tabpanel" aria-labelledby="nav-home-tab">
                            <div class="table-responsive-xl">
                                <table class="table table-hover" cellspacing="0">
                                  <tbody>
                                    <tr>
                                     <th scope="col" style="text-align: center;"><strong>ÊåáÊ®ô</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>Á∑öÂúñ</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>Ë≤°Â†±</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>ÂÖ¨Âè∏</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>ÂÉπÊ†º</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>52H</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>52L</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>Êº≤Ë∑å</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>PE</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>PB</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>PS</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>‰ªäÂπ¥PEG</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>ÊòéÂπ¥PEG</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>EPSÊàêÈï∑</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>ÁáüÊî∂ÊàêÈï∑</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>ÂàÜÊûê</strong></th>
                                     <th scope="col" style="text-align: center;"><strong>ÈóúÊ≥®</strong></th>
                                   </tr>
                                   <? for(var i in catInfo){ ?>
                                     <tr>
                                       <td style="text-align: center;"> <?= catInfo[i]['sign'] ?> </td>
                                       <td style="text-align: center;"><a href="https://script.google.com/macros/s/AKfycbzbzeGJ836vYiPAtquSFeMPGCVzGDSWYTlyaPrX3tpv7KzRBJg/exec?mode=historyData&symbol=<?= catInfo[i]['symbol'].toLowerCase()?>" target="_blank">üìà</a></td>
            
                                       <? if (catInfo[i]['cbsRanking'] == 'ËøáÁÉ≠'){ ?>
                                           <td style="text-align: center;"><a style="color: #D44D44;" href="https://caibaoshuo.com/companies/<?= catInfo[i]['symbol']?>" target="_blank">ÈÅéÁÜ±</a></td>
                                       <? }else if (catInfo[i]['cbsRanking'] == '‰∏≠Á≠â'){ ?>
                                           <td style="text-align: center;"><a style="color: #FCCC79;" href="https://caibaoshuo.com/companies/<?= catInfo[i]['symbol']?>" target="_blank">‰∏≠Á≠â</a></td>
                                       <? }else if (catInfo[i]['cbsRanking'] == '‰Ωé‰ª∑'){ ?>
                                           <td style="text-align: center;"><a style="color: #8FD17F;" href="https://caibaoshuo.com/companies/<?= catInfo[i]['symbol']?>" target="_blank">ÂÅè‰Ωé</a></td>
                                       <? }else if (catInfo[i]['cbsRanking'] == '‰Ωé‰º∞'){ ?>
                                           <td style="text-align: center;"><a style="color: #3D9CFF;" href="https://caibaoshuo.com/companies/<?= catInfo[i]['symbol']?>" target="_blank">‰Ωé‰º∞</a></td>
                                       <? }else if (catInfo[i]['cbsRanking'] == 'ËßÇÊúõ'){ ?>
                                           <td style="text-align: center;"><a style="color: #999999;" href="https://caibaoshuo.com/companies/<?= catInfo[i]['symbol']?>" target="_blank">ËßÄÊúõ</a></td>
                                       <? }else{ ?>
                                           <td style="text-align: center;"><?=catInfo[i]['cbsRanking']?></td>
                                       <? }?>
            
                                       <td style="text-align: center; white-space: nowrap">
                                           <a href="<?= catInfo[i]['url']?>" target="_blank">
                                               <?= catInfo[i]['companyName'] ?><br/>( <?= catInfo[i]['symbol']?> ) 
                                               <?if(catInfo[i]['volumeMark']){?><?=catInfo[i]['volumeMark']?><?}?>
                                               <?if(catInfo[i]['news']){?><?=catInfo[i]['news']?><?}?>
                                               <?if(catInfo[i]['beatAnalyst']){?><?=catInfo[i]['beatAnalyst']?><?}?>
                                           </a>
                                       </td>
                                       <td style="text-align: center;"><?= catInfo[i]['price'] ?></td>
            
                                       <? if ((catInfo[i]['52weekHigh'] - catInfo[i]['price'])/catInfo[i]['52weekHigh'] < 0.05){ ?>
                                           <td style="text-align: center;"><span style="color: #ffffff; background-color: #008000;"><?= catInfo[i]['52weekHigh'] ?></span></td>
                                       <? }else{ ?>
                                           <td style="text-align: center;"><?= catInfo[i]['52weekHigh'] ?></td>
                                       <? }?>
            
                                       <? if ((catInfo[i]['price'] - catInfo[i]['52weekLow'])/catInfo[i]['price'] < 0.05){ ?>
                                           <td style="text-align: center;"><span style="color: #ffffff; background-color: #ff0000;"><?= catInfo[i]['52weekLow'] ?></span></td>
                                       <? }else{ ?>
                                           <td style="text-align: center;"><?= catInfo[i]['52weekLow'] ?></td>
                                       <? }?>
            
                                       <? if (catInfo[i]['delta'] > 0){ ?>
                                           <td style="text-align: center; white-space: nowrap"><strong><span style="color: #339966;"><?= (catInfo[i]['delta']* 100).toFixed(1) ?> %</span></strong></td>
                                       <? }else if (catInfo[i]['delta'] < 0){ ?>
                                           <td style="text-align: center; white-space: nowrap"><strong><span style="color: #ff0000;"><?= (catInfo[i]['delta']* 100).toFixed(1) ?> %</span></strong></td>
                                       <? }else{ ?>
                                           <td style="text-align: center; white-space: nowrap"><strong><?= (catInfo[i]['delta']* 100).toFixed(1) ?> %</strong></td>
                                       <? }?>
            
                                       <? if (catInfo[i]['TTM'] > 0){ ?>
                                           <td style="text-align: center;"><strong><span style="color: #339966;"><?= Math.round(catInfo[i]['TTM']) ?></span></strong></td>
                                       <? }else if (catInfo[i]['TTM'] < 0){ ?>
                                           <td style="text-align: center;"><strong><span style="color: #ff0000;"><?= Math.round(catInfo[i]['TTM']) ?></span></strong></td>
                                       <? }else{ ?>
                                           <td style="height: 20px text-align: center;;"><strong><?= Math.round(catInfo[i]['TTM']) ?></strong></td>
                                       <? }?>
                                       
                                       <? if (catInfo[i]['pb'] > 0){ ?>
                                           <td style="text-align: center;"><strong><span style="color: #339966;"><?= Math.round(catInfo[i]['pb']) ?></span></strong></td>
                                       <? }else if (catInfo[i]['pb'] < 0){ ?>
                                           <td style="text-align: center;"><strong><span style="color: #ff0000;"><?= Math.round(catInfo[i]['pb']) ?></span></strong></td>
                                       <? }else{ ?>
                                           <td style="height: 20px text-align: center;"><strong><?= Math.round(catInfo[i]['pb']) ?></strong></td>
                                       <? }?>
                                       
                                       <td style="height: 20px text-align: center;"><strong><?= Math.round(catInfo[i]['ps']) ?></strong></td>
                                       
                                       <? if(catInfo[i]['thisEPS']){?>
                                           <? var speg = catInfo[i]['TTM']/catInfo[i]['thisEPS']?>
                                           <? if (catInfo[i]['TTM'] < 0 || catInfo[i]['thisEPS'] < 0){ ?>
                                               <td style="text-align: center;"></td>
                                           <? }else if (speg > 1){ ?>
                                               <td style="text-align: center;"><strong><span style="color: #ff0000;"><?= Math.round(speg*10)/10 ?></span></strong></td>
                                           <? }else{ ?>
                                               <td style="text-align: center;"><strong><span style="color: #339966;"><?= Math.round(speg*10)/10 ?></span></strong></td>
                                           <? }?>
                                       <? }else{ ?>
                                           <td style="text-align: center;"></td>
                                       <? }?>
                                       
                                       <? if(catInfo[i]['nextEPS']){?>
                                           <? var peg = catInfo[i]['TTM']/catInfo[i]['nextEPS']?>
                                           <? if (catInfo[i]['TTM'] < 0 || catInfo[i]['nextEPS'] < 0){ ?>
                                               <td style="text-align: center;"></td>
                                           <? }else if (peg > 1){ ?>
                                               <td style="text-align: center;"><strong><span style="color: #ff0000;"><?= Math.round(peg*10)/10 ?></span></strong></td>
                                           <? }else{ ?>
                                               <td style="text-align: center;"><strong><span style="color: #339966;"><?= Math.round(peg*10)/10 ?></span></strong></td>
                                           <? }?>
                                       <? }else{ ?>
                                           <td style="text-align: center;"></td>
                                       <? }?>
                                       <td style="height: 20px text-align: center; white-space: nowrap;"><strong><?= catInfo[i]['thisEPS'] ?>/<?= catInfo[i]['nextEPS']?></strong></td>
                                       <td style="height: 20px text-align: center; white-space: nowrap;"><strong><?= catInfo[i]['thisRevenue'] ?>/<?= catInfo[i]['nextRevenue']?></strong></td>
                                       
                                       <? if (catInfo[i]['analysis'].includes("‚Üó")){ ?>
                                           <td style="text-align: left;"><strong><span style="color: #339966;"><?= catInfo[i]['analysis'] ?></span></strong></td>
                                       <? }else if (catInfo[i]['analysis'].includes("‚Üò")){ ?>
                                           <td style="text-align: left;"><strong><span style="color: #ff0000;"><?= catInfo[i]['analysis'] ?></span></strong></td>
                                       <? }else{ ?>
                                           <td style="text-align: left; white-space: nowrap;"><?= catInfo[i]['analysis'] ?></td>
                                       <? }?>
            
                                       <? if (String(catInfo[i]['analystPopularity']).includes("‚Üó")){ ?>
                                           <td style="text-align: center; white-space: nowrap"><strong><span style="color: #339966;"><?= catInfo[i]['analystPopularity'] ?></span></strong></td>
                                       <? }else if (String(catInfo[i]['analystPopularity']).includes("‚Üò")){ ?>
                                           <td style="text-align: center; white-space: nowrap"><strong><span style="color: #ff0000;"><?= catInfo[i]['analystPopularity'] ?></span></strong></td>
                                       <? }else{ ?>
                                           <td style="text-align: center; white-space: nowrap"><?= catInfo[i]['analystPopularity'] ?></td>
                                       <? }?>
            
                                     </tr>
                                   <? } ?>
                                 </tbody>
                               </table>
                             </div>
                             </div>
                          <?}?>
                        </div>
                    </div>
                </div>
            </div>
        </section>


